{% extends "base.html" %}
{% load wagtailcore_tags wagtailimages_tags comments i18n%}


{% block content %}
{% if search_results %}
    <h2 class="search-result-title f-tiny">{% trans "your search results for: " %}{{search_query}}</h2>
  {% for page in search_results %}
    {% with parent_section=page.get_parent_section ancestor=page.get_parent_section.get_ancestors.last %}
        <div class="search-results-body">
         {% if ancestor.sectionpage.image %}
        <a href="{% pageurl page %}">
             <h6 class="search-result-section__title search-result-section__title{{page.get_parent_section.get_effective_extra_style_hints}}">
                 {{ parent_section.title }}
             </h6>
        </a>
        <div class="article-row">
            <div class="image-article-col">
                <a href="{% pageurl page %}">
                    {% image ancestor.sectionpage.image width-98 as tmp_photo %}
                    <img src="{{ tmp_photo.url }}" alt="{{ section.image.title }}"/>
                </a>
            </div>

            <div class="text-article-col">
                <a href="{% pageurl page %}" class="search-result-article-title">
                    <h3>{{page.title}}</h3>
                </a>
                <p>{{page.subtitle}}</p>
            </div>
        </div>
        {% else %}
         <a href="{% pageurl page %}">
             <h6 class="search-result-section__title search-result-section__title{{page.get_parent_section.get_effective_extra_style_hints}}">
                 {{ parent_section.title }}
             </h6>
         </a>
         <div class="article-row">
             <div class="image-article-col">
                 <a href="{% pageurl page %}">
                     {% image parent_section.sectionpage.image width-98 as tmp_photo %}
                 <img src="{{ tmp_photo.url }}" alt="{{ section.image.title }}"/></a>
             </div>
             <div class="text-article-col">
                 <a href="{% pageurl page %}" class="search-result-article-title">
                     <h3>{{ page.title }}</h3>
                 </a>
                 <p>{{ page.subtitle }}</p>
             </div>
         </div>
     </div>
    {% endif %}
    {% endwith %}
  {% endfor %}

  <div class="search-result pagination">
  <div class="pagination-step-links">
    {% if search_results.has_previous %}
        <a href="?p={{ search_results.previous_page_number }}&amp;q={{search_query}}">&larr;</a>
    {% endif %}

    <span class="current">
        Page {{ search_results.number }} of {{ search_results.paginator.num_pages }}
    </span>

    {% if search_results.has_next %}
        <a href="?p={{ search_results.next_page_number }}&amp;q={{search_query}}">&rarr;</a>
    {% endif %}
  </div>
  </div>

  {% else %}
    <div class="search-title l-indent">
        <h2 class="search-result-title">{% trans "Search" %}</h2>
    </div>
    <div class="block turq">
        <p>{% trans "No search results for " %}{{search_query}}.</p>
        <div class="signin-form">
            <form action="{% url 'search' %}">
              <input placeholder="{% trans "I am looking for" %}" name="q" type="search">
              <input type="submit" class="submit-button" value="{% trans "Search"%}">
            </form>
        </div>
    </div>
    <hr>
  {% endif %}
{% endblock %}

{% block search %}
  {% if search_results %}
      {% include "search/search_block.html" %}
  {% endif %}
{% endblock %}
