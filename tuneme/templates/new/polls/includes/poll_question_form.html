{% load i18n poll_votings %}
{% if form.choice.errors %}
  <h5 class="errors">{{form.choice.errors|join:", " }}</h5>
{% endif %}
<form class="polls__form" action="{% url 'polls:vote' question.id %}" method="post">
  {% csrf_token %}
  {% load_choices_for_poll_page question as choices %}
    {% if not request.user.is_authenticated%}
    <ul class="poll-choices">
    {% for choice in choices %}
    <li class="poll-choices__item">
      {% if question.get_main_language_page.allow_multiple_choices %}
       <label for="choice{{ forloop.counter }}">
        <input type="checkbox" name="choice" id="choice{{ forloop.counter }}" value="{{ choice.get_main_language_page.id }}" />
       {{ choice.title }}</label>
      {% else %}
       <label for="choice{{ forloop.counter }}">
        <input type="radio" name="choice" id="choice{{ forloop.counter }}" value="{{ choice.get_main_language_page.id }}" />
        {{ choice.title }}</label>
      {% endif %}
    </li>
    {% endfor %}
    </ul>
  <a href="{% url 'molo.profiles:auth_login' %}?next={{request.path}}">
  {% trans "Log in" %}</a>
  {% trans "or" %}
  <a href="{% url 'molo.profiles:user_register' %}">
  {% trans "Register" %}
  </a> {% trans "to vote" %}
  {% else %}
  {% can_vote question as can_user_vote %}
  {% if can_user_vote %}
    <ul class="poll-choices">
    {% for choice in choices %}
      <li class="poll-choices__item">
      {% if question.get_main_language_page.allow_multiple_choices %}
        <label for="choice{{ forloop.counter }}">
          <input type="checkbox" name="choice" id="choice{{ forloop.counter }}" value="{{ choice.get_main_language_page.id }}" />
          {{ choice.title }}
        </label>
      {% else %}
        <label for="choice{{ forloop.counter }}">
        <input type="radio" name="choice" id="choice{{ forloop.counter }}" value="{{ choice.get_main_language_page.id }}" />
        {{ choice.title }}
        </label>
      {% endif %}
      </li>
    {% endfor %}
    </ul>
  <input type="submit" value="{% trans "Vote" %}" />
  {% elif question.get_main_language_page.show_results %}
    <a href="{% url 'polls:results' question.id %}">
      {% trans "Show Results" %}</a>
  {% elif not question.get_main_language_page.show_results %}
    {% user_choice question as user_choice %}
    <h5>{% trans "You voted: " %}{{user_choice}}</h5>
  {% endif %}
  {% endif %}
</form>
